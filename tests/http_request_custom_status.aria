# SPDX-License-Identifier: Apache-2.0

### TAGS: FLAKEY

import Request from aria.network.request;
import * from aria.network.retry;

func main() {
    val request = Request.new("https://httpbin.org/status/418");

    val result = retry(|| => request.get(), |result| => {
        println(result);
        return result.is_Ok() && result.unwrap_Ok().status_code == 418;
    });
    assert result.is_Pass();
}
